/*! grapesjs-rulers - 1.0.8 */
!function(e,t){'object'==typeof exports&&'object'==typeof module?module.exports=t():'function'==typeof define&&define.amd?define([],t):'object'==typeof exports?exports["grapesjs-rulers"]=t():e["grapesjs-rulers"]=t()}(window,(function(){return function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){'undefined'!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:'Module'}),Object.defineProperty(e,'__esModule',{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&'object'==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,'default',{enumerable:!0,value:e}),2&t&&'string'!=typeof e)for(var r in e)n.d(i,r,function(t){return e[t]}.bind(null,r));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e['default']}:function(){return e};return n.d(t,'a',t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=3)}([function(e,t){e.exports=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}},function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},function(e,t){function n(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}e.exports=function(e,t,i){return t&&n(e.prototype,t),i&&n(e,i),e}},function(e,t,n){"use strict";n.r(t);var i=n(0),r=n.n(i),o=n(1),s=n.n(o),l=n(2),a=n.n(l),u=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};s()(this,e),this.api=this.builder(),this.utils=c,this.canvasPointerEvents=t.canvas.style.pointerEvents,this.options=t,this.api.constructRulers(t)}return a()(e,[{key:"builder",value:function(){var e,t=this,n=1,i=2,r=0,o=0,s=0,l=0,a=1,u={},c=[],d=document.createElement('div'),f=[],p={rulerHeight:15,fontFamily:'arial',fontSize:'8px',strokeStyle:'gray',sides:['top','left'],cornerSides:['TL'],lineWidth:1,enableMouseTracking:!0,enableToolTip:!0},v=function(e,n){switch(e.canvas.style.left=t.utils.pixelize(-(e.canvas.width/2-e.canvas.height)),n){case'top':e.orgPos=parseInt(e.canvas.style.left);break;case'left':e.canvas.style.top=t.utils.pixelize(-e.canvas.height-1),e.orgPos=parseInt(e.canvas.style.top),function(e,n){var i='rotate('+n+'deg)',r=t.utils.pixelize(Math.abs(parseInt(e.canvas.style.left)))+' 100%';e.canvas.style.webkitTransform=i,e.canvas.style.MozTransform=i,e.canvas.style.OTransform=i,e.canvas.style.msTransform=i,e.canvas.style.transform=i,e.canvas.style.webkitTransformOrigin=r,e.canvas.style.MozTransformOrigin=r,e.canvas.style.OTransformOrigin=r,e.canvas.style.msTransformOrigin=r,e.canvas.style.transformOrigin=r}(e,90)}},g=function(i,u,f,p,v){var g,y=document.createElement('div'),h=i===n?'rul_lineVer':'rul_lineHor',m=i===n?r:o;y.title='Double click to delete',y.dataset.id=c.length,t.utils.addClasss(y,['rul_line',h]),y=d.appendChild(y),i===n?(y.style.left=t.utils.pixelize(u-e.container.getBoundingClientRect().left),v&&(y.style.left=t.utils.pixelize(Math.round(u/a+e.rulerHeight-s)))):(y.style.top=t.utils.pixelize(f-e.container.getBoundingClientRect().top),v&&(y.style.top=t.utils.pixelize(Math.round(f/a+e.rulerHeight-l)))),c.push({dimension:i,line:t.guideLine(y,e.container.querySelector('.rul_wrapper'),i,e,m,(function(t,i,r){var o=t.dimension===n?i:r;t.assigned()?o<e.rulerHeight&&(c.some((function(e,n){if(e.line===t)return g=n,!0})),t.destroy(),c.splice(g,1)):o>e.rulerHeight&&t.assigned(!0)}),p,a)})},y=function(r,o){var s,l,a,c='left'===o||'right'===o?n:i,d=c===n?'rul_ruler_Vertical':'rul_ruler_Horizontal',f=document.createElement('canvas');t.utils.addClasss(f,['rul_ruler',d,'rul_align_'+o]),s=r.appendChild(f),u[o]=t.rulerConstructor(s,e,c),u[o].drawRuler(r.offsetWidth,e.rulerHeight),v(u[o],o),l=u[o],a=function(e){g(l.dimension,e.clientX,e.clientY,e)},l.canvas.addEventListener('mousedown',a),l.clearListeners=function(){l.canvas.removeEventListener('mousedown',a)}},h=function(){function n(e){e.stopPropagation(),x()}return function(i,r){r.forEach((function(r){var o=function(n,i){var r=document.createElement('div'),o='rul_corner'+i.toUpperCase();return r.title='Clear Guide lines',t.utils.addClasss(r,['rul_corner',o,e.cornerIcon]),r.style.width=t.utils.pixelize(e.rulerHeight+1),r.style.height=t.utils.pixelize(e.rulerHeight),r.style.lineHeight=t.utils.pixelize(e.rulerHeight),n.appendChild(r)}(i,r);o.addEventListener('mousedown',n),o.destroy=function(){o.removeEventListener('mousedown',n),o.parentNode.removeChild(o)},f.push(o)}))}}(),m=function(e){c.forEach((function(e){e.line.stopDrag()}))},b=function(e){var t=0;for(var n in u)u.hasOwnProperty(n)&&e(u[n],t++)},x=function(){c.forEach((function(e){e.line.destroy()})),c=[]};return{VERTICAL:n,HORIZONTAL:i,getPos:function(){return{x:r,y:o}},setPos:function(e){var s,l=0,a=0,u=0;b((function(i){i.dimension===n?(s=i.canvas.style.top,i.canvas.style.top=t.utils.pixelize(i.orgPos+parseInt(e.y)),u=parseInt(s)-parseInt(i.canvas.style.top)):(l=i.canvas.style.left,i.canvas.style.left=t.utils.pixelize(i.orgPos+parseInt(e.x)),a=parseInt(l)-parseInt(i.canvas.style.left))})),c.forEach((function(n){n.dimension===i?(n.line.guideLine.style.top=t.utils.pixelize(parseInt(n.line.guideLine.style.top)-u),n.line.curPosDelta(parseInt(e.y))):(n.line.guideLine.style.left=t.utils.pixelize(parseInt(n.line.guideLine.style.left)-a),n.line.curPosDelta(parseInt(e.x)))})),r=parseInt(e.x),o=parseInt(e.y)},setScroll:function(e){s=e.x,l=e.y},setScale:function(n){var s,l,u;b((function(e){e.context.clearRect(0,0,e.canvas.width,e.canvas.height),e.context.beginPath(),e.setScale(n),e.context.stroke(),a=n})),c.forEach((function(a){a.dimension===i?(s=parseInt(a.line.guideLine.style.top),l=e.rulerHeight+1,u=parseFloat(n)/a.line.curScale(),a.line.guideLine.style.top=t.utils.pixelize((s-l-o)/u+l+o),a.line.curScale(n)):(s=parseInt(a.line.guideLine.style.left),l=e.rulerHeight+1,u=parseFloat(n)/a.line.curScale(),a.line.guideLine.style.left=t.utils.pixelize((s-l-r)/u+l+r),a.line.curScale(n))}))},clearGuides:x,removeGuide:function(e){var t=c.length-1,n=[c[t],c[e]];c[e]=n[0],c[t]=n[1],c.pop()},getGuides:function(){return c.map((function(t){return{posX:Math.round((parseInt(t.line.guideLine.style.left)-e.rulerHeight+s)*a),posY:Math.round((parseInt(t.line.guideLine.style.top)-e.rulerHeight+l)*a),dimension:t.dimension}}))},setGuides:function(e){e&&e.length&&e.forEach((function(e){g(e.dimension,e.posX,e.posY,null,!0)}))},constructRulers:function(n){d=t.utils.addClasss(d,'rul_wrapper'),e=t.utils.extend(p,n),d=e.container.appendChild(d),e.sides.forEach((function(e){y(d,e)})),h(d,e.cornerSides),e.container.addEventListener('mouseup',m)},toggleRulerVisibility:function(t){var n=t?'block':'none';d.style.display=n;var i=e.container.querySelectorAll('.rul_tracker');i.length>0&&(i[0].style.display=n,i[1].style.display=n)},toggleGuideVisibility:function(e){var t=e?'show':'hide';c.forEach((function(e){e.line[t]()}))},destroy:function(){x(),b((function(e){e.destroy()})),f.forEach((function(e){e.destroy()})),e.container.removeEventListener('mouseup',m),d.parentNode.removeChild(d)}}}},{key:"rulerConstructor",value:function(e,t,n){var i=this,r=e,o=r.getContext('2d'),s=0,l=0,a=1,u=n||2,c=document.createElement('div'),d=function(){return a},f=function(){for(var e=0,t='',n=0,i=!1,r=0,u=s/2,c=s/2,d=0;d<=l;d+=1)i=!1,t='',(n=l/2-d)%50==0?(e=r,t=Math.round(Math.abs(n)*a),i=!0):n%25==0?(e=u,i=!0):n%5==0&&(e=c,i=!0),i&&(o.moveTo(d+.5,s+.5),o.lineTo(d+.5,e+.5),o.fillText(t,d+1.5,s/2+1))},p=function(e){var n=e.clientX,r=e.clientY;if('IFRAME'===e.target.tagName){var o=Math.pow(d(),-1);n=n*o+e.target.getBoundingClientRect().left,r=r*o+e.target.getBoundingClientRect().top}2===u?c.style.left=i.utils.pixelize(n-t.container.getBoundingClientRect().left):c.style.top=i.utils.pixelize(r-t.container.getBoundingClientRect().top)};return t.enableMouseTracking&&function(){c=t.container.appendChild(c),i.utils.addClasss(c,'rul_tracker');var e=i.utils.pixelize(t.rulerHeight);2===u?c.style.height=e:c.style.width=e,t.container.addEventListener('mousemove',p)}(),{getLength:function(){return l},getThickness:function(){return s},getScale:d,setScale:function(e){return a=parseFloat(e),f(),a},dimension:u,orgPos:0,canvas:r,context:o,drawRuler:function(e,n,i){l=r.width=4*e,s=r.height=n,a=i||a,o.strokeStyle=t.strokeStyle,o.fillStyle=t.fillStyle,o.font=t.fontSize+' '+t.fontFamily,o.lineWidth=t.lineWidth,o.beginPath(),f(),o.stroke()},drawPoints:f,destroy:function(){t.container.removeEventListener('mousemove',p),c.parentNode.removeChild(c),i.clearListeners&&i.clearListeners()}}}},{key:"guideLine",value:function(e,t,n,i,r,o,s,l){var a,u=this,c=e,d=l||1,f=!1,p=r||0,v=t,g=n||2,y=o||function(){},h={cv:function(){return u.options.canvas},move:function(e,t){c.style.left=u.utils.pixelize(e),c.style.top=u.utils.pixelize(t),b(e,t),y(a,e,t)},startMoving:function(e){h.cv().style.pointerEvents='none',u.utils.addClasss(c,['rul_line_dragged']);var t=(e=e||window.event)?e.clientX:0,n=e?e.clientY:0,r=parseInt(c.style.top||0),o=parseInt(c.style.left||0),s=parseInt(c.offsetWidth),l=parseInt(c.offsetHeight),a=parseInt(v.offsetWidth),d=parseInt(v.offsetHeight),f=2===g?'ns-resize':'ew-resize';i.container.style.cursor=f,c.style.cursor=f;var p=t-o,y=n-r;document.onmousemove=function(e){var t=(e=e||window.event).clientX,n=e.clientY,i=t-p,r=n-y;i<0&&(i=0),r<0&&(r=0),i+s>a&&(i=a-s),r+l>d&&(r=d-l),h.move(i,r)},m()},stopMoving:function(){h.cv().style.pointerEvents=u.canvasPointerEvents,i.container.style.cursor=null,c.style.cursor=null,document.onmousemove=function(){},x(),u.utils.removeClasss(c,['rul_line_dragged'])}},m=function(e){i.enableToolTip&&u.utils.addClasss(c,'rul_tooltip')},b=function(e,t){c.dataset.tip=t?Math.round((t-i.rulerHeight-1-p)*d)+'px':Math.round((e-i.rulerHeight-1-p)*d)+'px'},x=function(e){u.utils.removeClasss(c,'rul_tooltip')},w=function(){h.stopMoving(),y=null,c.removeEventListener('mousedown',C),c.removeEventListener('mouseup',E),c.removeEventListener('dblclick',O),c.parentNode&&c.parentNode.removeChild(c)},C=function(e){e.stopPropagation(),h.startMoving()},E=function(e){h.stopMoving()},O=function(e){e.stopPropagation(),w(),u.api.removeGuide(c.dataset.id)};return c.addEventListener('mousedown',C),c.addEventListener('mouseup',E),c.addEventListener('dblclick',O),s&&h.startMoving(s),a={setAsDraggable:h,startDrag:h.startMoving,stopDrag:h.stopMoving,destroy:w,curScale:function(e){return void 0===e?d:d=e},assigned:function(e){return void 0===e?f:f=e},curPosDelta:function(e){return void 0===e?p:p=e},guideLine:c,dimension:g,hide:function(){c.style.display='none'},show:function(){c.style.display='block'}}}}]),e}(),c={extend:function(){for(var e=1;e<arguments.length;e++)for(var t in arguments[e])arguments[e].hasOwnProperty(t)&&(arguments[0][t]=arguments[e][t]);return arguments[0]},pixelize:function(e){return e+'px'},prependChild:function(e,t){return e.insertBefore(t,e.firstChild)},addClasss:function(e,t){return t instanceof Array||(t=[t]),t.forEach((function(t){e.className+=' '+t})),e},removeClasss:function(e,t){var n=e.className;return t instanceof Array||(t=[t]),t.forEach((function(e){n=n.replace(e,'')})),e.className=n,e}};function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){r()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}t["default"]=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=f(f({},{dragMode:'translate',rulerHeight:15,canvasZoom:94,rulerOpts:{}}),n),r=e.Commands,o=i.rulerHeight,s=e.getConfig('dragMode'),l=i.canvasZoom,a=100/l;r.add('ruler-visibility',{run:function(e){!t&&(t=new u(f({container:e.Canvas.getCanvasView().el,canvas:e.Canvas.getFrameEl(),rulerHeight:o,strokeStyle:'white',fillStyle:'white',cornerIcon:'fa fa-trash'},i.rulerOpts)))&&e.on('canvasScroll frame:scroll change:canvasOffset',(function(){c()})),e.Rulers=t,t.api.toggleRulerVisibility(!0),e.Canvas.setZoom(l),e.setDragMode(i.dragMode),c(),t.api.setScale(a)},stop:function(e){t&&t.api.toggleRulerVisibility(!1),e.Canvas.setZoom(100),e.setDragMode(s)}});var c=function(){var n=e.Canvas.getOffset(),i=n.top,r=n.left,s=e.Canvas.getBody().scrollLeft,l=e.Canvas.getBody().scrollTop;t.api.setPos({x:r-o-s/a,y:i-o-l/a}),t.api.setScroll({x:s,y:l})};r.add('guides-visibility',{run:function(){t&&t.api.toggleGuideVisibility(!0)},stop:function(){t&&t.api.toggleGuideVisibility(!1)}}),r.add('get-rulers',(function(){return t})),r.add('get-rulers-constructor',(function(){return u})),r.add('clear-guides',(function(){t&&t.api.clearGuides()})),r.add('get-guides',(function(){return t?t.api.getGuides():0})),r.add('set-guides',(function(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};t&&i.guides&&t.api.setGuides(i.guides)})),r.add('set-zoom',(function(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};l=i.zoom,a=100/l,e.Canvas.setZoom(l),c(),t&&t.api.setScale(a)})),r.add('destroy-ruler',(function(){t&&t.api.destroy()}))}}])}));
//# sourceMappingURL=grapesjs-rulers.min.js.map